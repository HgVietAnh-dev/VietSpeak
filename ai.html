<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ph√¢n T√≠ch - VietSpeak Academy</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #1a3a5f;
            --accent: #e63946;
            --white: #ffffff;
            --bg: #f4f7f6;
            --text-dark: #2d3436;
            --transition: all 0.3s ease;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* --- HEADER (ƒê·ªìng b·ªô trang ch·ªß) --- */
        header {
            background: var(--white);
            padding: 1rem 8%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
        }

        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6rem;
            font-weight: 900;
            color: var(--primary);
            text-decoration: none;
            text-transform: uppercase;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            margin-left: 2rem;
            font-weight: 700;
            font-size: 0.85rem;
            text-transform: uppercase;
            transition: var(--transition);
        }

        nav a:hover, nav a.active { color: var(--accent); }

        /* --- CONTAINER --- */
        .container {
            max-width: 1200px;
            margin: 50px auto;
            padding: 0 20px;
        }

        .page-title {
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 40px;
        }

        .page-title span { color: var(--accent); }

        /* --- BOX PH√ÇN T√çCH --- */
        .split-box {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .card {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            border: 1px solid #eee;
        }

        .card:hover { transform: translateY(-5px); }

        .card h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            margin-bottom: 25px;
            color: var(--primary);
            text-transform: uppercase;
        }

        /* --- UPLOAD AREA --- */
        .upload-zone {
            border: 2px dashed #cbd5e0;
            padding: 30px;
            border-radius: 15px;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
            display: block;
        }

        .upload-zone:hover {
            border-color: var(--accent);
            background: #fffafa;
        }

        .upload-zone span {
            display: block;
            color: #718096;
            font-size: 0.9rem;
        }

        .upload-zone input { display: none; }

        /* --- PREVIEW --- */
        #audioPreview {
            width: 100%;
            margin: 15px 0;
            height: 40px;
        }

        .preview-img {
            width: 100%;
            max-height: 250px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
            display: none;
        }

        /* --- BUTTON --- */
        .analyze-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .analyze-btn:hover {
            background: var(--accent);
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.3);
        }

        /* --- RESULT BOX --- */
        .result-wrapper {
            margin-top: 50px;
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            border-left: 8px solid var(--accent);
        }

        .result-wrapper h3 {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary);
            margin-bottom: 20px;
        }

        #result {
            white-space: pre-line;
            color: #4a5568;
            font-size: 1.05rem;
            line-height: 1.8;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .split-box { grid-template-columns: 1fr; }
            header { flex-direction: column; padding: 1rem; }
            nav { margin-top: 1rem; }
            nav a { margin: 0 10px; font-size: 0.75rem; }
        }
    </style>
</head>

<body>

    <header>
        <a href="index.html" class="logo">VietSpeak</a>
        <nav>
            <a href="index.html">Trang ch·ªß</a>
            <a href="khoa-hoc.html">Kho√° h·ªçc</a>
            <a href="ai.html">AI Ph√¢n T√≠ch</a>
            <a href="thu-vien.html">Th∆∞ vi·ªán t√†i li·ªáu</a>
            <a href="account.html">T√†i kho·∫£n</a>
        </nav>
    </header>

    <div class="container">
        <h1 class="page-title">H·ªá Th·ªëng <span>AI Ch·∫©n ƒêo√°n</span></h1>

        <div class="split-box">
            <div class="card">
                <h2>Ph√¢n t√≠ch Gi·ªçng n√≥i</h2>
                <label class="upload-zone">
                    <p style="font-size: 2rem; margin-bottom: 10px;">üéôÔ∏è</p>
                    <span>T·∫£i l√™n file √¢m thanh (.mp3, .wav)</span>
                    <input type="file" id="audioInput" accept="audio/*">
                </label>
                <audio id="audioPreview" controls style="display:none;"></audio>
                <button class="analyze-btn" onclick="analyzeAudio()">B·∫Øt ƒë·∫ßu ph√¢n t√≠ch</button>
            </div>

            <div class="card">
                <h2>Ph√¢n t√≠ch H√¨nh ·∫£nh</h2>
                <label class="upload-zone">
                    <p style="font-size: 2rem; margin-bottom: 10px;">üì∏</p>
                    <span>T·∫£i l√™n ·∫£nh ch√¢n dung thuy·∫øt tr√¨nh</span>
                    <input type="file" id="imgInput" accept="image/*">
                </label>
                <img id="preview" class="preview-img" />
                <button class="analyze-btn" onclick="analyzeImage()">Ki·ªÉm tra phong th√°i</button>
            </div>
        </div>

        <div class="result-wrapper">
            <h3>B√°o c√°o chi ti·∫øt t·ª´ AI</h3>
            <div id="result">K·∫øt qu·∫£ ph√¢n t√≠ch s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y sau khi b·∫°n t·∫£i file v√† nh·∫•n n√∫t...</div>
        </div>
    </div>

    <script>
        // --- GI·ªÆ NGUY√äN LOGIC JAVASCRIPT C·ª¶A B·∫†N NH∆ØNG C·∫¨P NH·∫¨T GIAO DI·ªÜN ---
        let OPENAI_API_KEY =
            "sk-proj-82rQpSfAbL9Wr8ZuVzBfDpH2aQGQ3YjeQ8WNxTBSLkROUlMGSXCE-QtuhcwZCC3Uvxle4gZBwwT3BlbkFJgX3I_Si3A04a3p2y-" +
            "LDD5kKfMASDOmVbpxviI3LDa-08COZe3lfNRAXSjStlR14VSvYaBeQMEA";

        /* ----------- PREVIEW AUDIO ----------- */
        document.getElementById("audioInput").onchange = function () {
            const file = this.files[0];
            const audio = document.getElementById("audioPreview");

            if (file) {
                audio.src = URL.createObjectURL(file);
                audio.style.display = "block";
            } else {
                audio.style.display = "none";
                audio.src = "";
            }
        };

        /* ----------- PH√ÇN T√çCH GI·ªåNG N√ìI ----------- */
        async function analyzeAudio() {
            const fileInput = document.getElementById("audioInput");
            const resultBox = document.getElementById("result");

            if (!fileInput.files[0]) {
                resultBox.innerText = "Vui l√≤ng ch·ªçn file mp3!";
                return;
            }

            resultBox.innerText = "ƒêang ph√¢n t√≠ch gi·ªçng n√≥i...";

            const file = fileInput.files[0];
            const formData = new FormData();

            formData.append("file", file);
            formData.append("model", "gpt-4o-mini-tts");
            formData.append("response_format", "text");

            try {
                const whisperRes = await fetch("https://api.openai.com/v1/audio/transcriptions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${OPENAI_API_KEY}` },
                    body: formData
                });

                const text = await whisperRes.text();

                const payload = {
                    model: "gpt-4o-mini",
                    messages: [{
                        role: "user",
                        content:
                            "H√£y ph√¢n t√≠ch gi·ªçng n√≥i ch·∫•m tr√™n thang ƒëi·ªÉm 10 theo c√°c ti√™u ch√≠: 1. C·∫£m x√∫c; 2. T·ªëc ƒë·ªô n√≥i; 3. S·ª± r√µ r√†ng; 4. Nh·∫•n nh√°; 5. T·ª± tin. Sau ƒë√≥ g·ª£i √Ω c·∫£i thi·ªán. N·ªôi dung gi·ªçng n√≥i: " + text
                    }]
                };

                const chatRes = await fetch("https://api.openai.com/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify(payload)
                });

                const data = await chatRes.json();
                resultBox.innerText = data.choices[0].message.content;

            } catch (err) {
                resultBox.innerText = "L·ªói k·∫øt n·ªëi ho·∫∑c CORS.\n" + err;
            }
        }


        /* ----------- PH√ÇN T√çCH ·∫¢NH ----------- */
        document.getElementById("imgInput").onchange = function () {
            const file = this.files[0];
            const img = document.getElementById("preview");

            img.src = URL.createObjectURL(file);
            img.style.display = "block";
        };

        async function analyzeImage() {
            const fileInput = document.getElementById("imgInput");
            const resultBox = document.getElementById("result");

            if (!fileInput.files[0]) {
                resultBox.innerText = "Vui l√≤ng ch·ªçn ·∫£nh!";
                return;
            }

            resultBox.innerText = "ƒêang ph√¢n t√≠ch ·∫£nh...";

            const base64 = await toBase64(fileInput.files[0]);

            const payload = {
                model: "gpt-4o-mini",
                messages: [
                    {
                        role: "user",
                        content: [
                            { type: "text", text: "H√£y nh·∫≠n x√©t theo c√°c y·∫øu t·ªë: 1. T∆∞ th·∫ø; 2. Trang ph·ª•c; 3. N√©t m·∫∑t; 4. √Ånh m·∫Øt; 5. Phong th√°i. Ch·∫•m ƒëi·ªÉm 10 v√† g·ª£i √Ω ph√°t tri·ªÉn." },
                            { type: "image_url", image_url: { url: base64 } }
                        ]
                    }
                ]
            };

            try {
                const res = await fetch("https://api.openai.com/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify(payload)
                });

                const data = await res.json();
                resultBox.innerText = data.choices[0].message.content;

            } catch (err) {
                resultBox.innerText = "L·ªói k·∫øt n·ªëi ho·∫∑c CORS.\n" + err;
            }
        }

        /* ----------- BASE64 ----------- */
        function toBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
    </script>
</body>
</html>